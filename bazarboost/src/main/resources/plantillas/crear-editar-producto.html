<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
  <head th:replace="~{layout :: commonHead}"></head>



  <!-- Definir el fragmento con el título y los estilos específicos -->
  <th:block th:fragment="headExtras">
    <title th:text="${modo == 'crear' ? 'BazarBoost - Crear Producto' : 'BazarBoost - Editar Producto'}">BazarBoost - Crear/Editar Producto</title>
    <link rel="stylesheet" href="/estilos/base.css" />
    <link rel="stylesheet" href="/estilos/base-creacion-edicion.css" />
  </th:block>

  <body>

    <!-- Incluir el Navbar -->
    <div th:insert="~{layout :: navbar}"></div>

    <div class="container my-4 main-content" id="bodyContainer">
      <h2 class="mb-4" th:text="${modo == 'crear' ? 'Crear Producto' : 'Editar Producto'}"></h2>

      <!-- Formulario para crear o editar producto -->
      <form th:action="${modo == 'crear' ? '/productos/crear' : '/productos/editar/' + producto.id}" th:method="${modo == 'crear' ? 'post' : 'patch'}" enctype="multipart/form-data" th:object="${producto}">

        <!-- Sección para mensajes de advertencia -->
        <div th:if="${errores != null and !errores.isEmpty()}"
             class="alert alert-danger"
             id="warning-danger">
          <i class="bi bi-exclamation-triangle"></i>
          <span id="warning-message">No se pudo completar la acción. Solucione los siguientes errores:</span>

          <!-- Lista de errores -->
          <ul>
            <li th:each="err : ${errores}" th:text="${err.defaultMessage}"></li>
          </ul>
        </div>


        <div class="mb-3">
          <label for="nombreProducto" class="form-label">Nombre del Producto</label>
          <input type="text" class="form-control" id="nombreProducto" th:field="*{nombre}" placeholder="Nombre del Producto" required />
        </div>

        <div class="mb-3">
          <label for="descripcionProducto" class="form-label">Descripción del Producto</label>
          <textarea class="form-control" id="descripcionProducto" th:field="*{descripcion}" rows="3" placeholder="Descripción del Producto" required></textarea>
        </div>

        <div class="mb-3">
          <label for="precioProducto" class="form-label">Precio</label>
          <input type="number" class="form-control" id="precioProducto" th:field="*{precio}" placeholder="Precio" min="0" step="1" required />
        </div>

        <div class="mb-3">
          <label for="cantidadProducto" class="form-label">Cantidad en Existencia</label>
          <input type="number" class="form-control" id="cantidadProducto" th:field="*{existencia}" placeholder="Cantidad en Existencia" min="0" required />
        </div>

        <div class="mb-3">
          <label for="categoriaProducto" class="form-label">Categoría</label>
          <select class="form-select" id="categoriaProducto" name="categoriaId" required>
            <option value="" selected disabled>Seleccione una Categoría</option>
            <option value="-1">Sin categoría</option>
            <option th:each="categoria : ${categorias}" th:value="${categoria.categoriaId}" th:text="${categoria.nombre}"></option>
          </select>
        </div>

        <div class="mb-3">
          <label for="descuentoProducto" class="form-label">Descuento</label>
          <select class="form-select" id="descuentoProducto" name="descuentoId">
            <option value="" selected disabled>Seleccione un Descuento</option>
            <option value="-1">Sin descuento</option>
            <option th:each="descuento : ${descuentos}" th:value="${descuento.descuentoId}" th:text="${descuento.nombre} + ' - ' + ${descuento.porcentaje} + '%'"></option>
          </select>
        </div>

        <div class="mb-3">
          <label for="imagenProducto" class="form-label">Imagen del Producto</label>
          <input type="file" class="form-control" id="imagenProducto" name="imagenArchivo" />
        </div>

        <!-- Botones -->
        <div class="d-flex justify-content-between" id="buttonsContainer">
          <a href="lista-productos-vendedor.html" type="button" class="btn btn-secondary">
            <i class="bi bi-arrow-left"></i> Volver a la lista de productos
          </a>
          <button type="submit" class="btn btn-primary">
            <i class="bi bi-save"></i> Guardar producto
          </button>
        </div>
      </form>
    </div>

    <div th:insert="~{layout :: footer}"></div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
